<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Seniorzy</title>
    <style>
    :root {
        --primary: #1e3a8a;    /* Głęboki granat */
        --accent: #2563eb;      /* Żywy niebieski */
        --bg: #f1f5f9;          /* Jasnoszare, niemęczące tło */
        --text: #1e293b;        /* Ciemny grafit dla lepszego kontrastu */
        --white: #ffffff;
    }

    * { 
        margin: 0; 
        padding: 0; 
        box-sizing: border-box; 
        -webkit-tap-highlight-color: transparent; 
    }

    body { 
        font-family: 'Segoe UI', system-ui, -apple-system, sans-serif; 
        background: var(--bg); 
        color: var(--text); 
        line-height: 1.6;
    }

    /* NAGŁÓWEK */
    .header-top { 
        background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%); 
        padding: 50px 20px; 
        text-align: center; 
        border-bottom-left-radius: 50px; 
        border-bottom-right-radius: 50px; 
        color: white; 
        box-shadow: 0 10px 30px rgba(30,58,138,0.3);
    }
    .header-top h1 { 
        font-size: 36px; 
        text-transform: uppercase; 
        font-weight: 900; 
        letter-spacing: 3px; 
        text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
    }
    .header-top p { 
        font-size: 17px; 
        opacity: 0.95; 
        margin-top: 10px; 
        font-weight: 500;
        letter-spacing: 1px;
    }

    /* WYSZUKIWARKA */
    #city-search-box {
        display: none; 
        padding: 20px; 
        background: var(--white); 
        margin: -25px 30px 20px 30px; 
        border-radius: 30px; 
        box-shadow: 0 15px 35px rgba(0,0,0,0.1); 
        text-align: center;
        position: relative;
        z-index: 10;
    }
    #city-input { 
        width: 70%; 
        padding: 14px 20px; 
        border-radius: 15px; 
        border: 2px solid #e2e8f0; 
        font-size: 16px; 
        outline: none;
        transition: border-color 0.3s;
    }
    #city-input:focus { border-color: var(--accent); }
    #city-search-btn { 
        width: 25%; 
        padding: 14px; 
        border-radius: 15px; 
        background: var(--primary); 
        color: white; 
        border: none; 
        font-weight: 900; 
        margin-left: 5px;
        cursor: pointer;
    }

    /* POGODA */
    .weather-section { padding: 30px 0 10px 0; }
    .tv-scroll { 
        display: flex; 
        overflow-x: auto; 
        gap: 20px; 
        padding: 10px 25px; 
        scrollbar-width: none; 
    }
    .tv-scroll::-webkit-scrollbar { display: none; }
    
    .tv-card { 
        min-width: 145px; 
        background: var(--white); 
        padding: 22px; 
        border-radius: 30px; 
        box-shadow: 0 8px 20px rgba(0,0,0,0.06); 
        text-align: center; 
        border: 1px solid #f1f5f9;
        transition: transform 0.2s;
    }
    .tv-card.user-city { 
        border: 3px solid var(--accent); 
        background: #f0f7ff; 
        transform: scale(1.05);
    }
    
    .add-city-btn {
        min-width: 110px; 
        background: #f8fafc; 
        border-radius: 30px; 
        display: flex; 
        flex-direction: column; 
        align-items: center; 
        justify-content: center;
        cursor: pointer; 
        border: 3px dashed #cbd5e1; 
        color: #64748b; 
        font-weight: 800;
    }

    .tv-name { font-weight: 800; color: var(--primary); font-size: 13px; margin-bottom: 8px; text-transform: uppercase; }
    .tv-item { font-size: 26px; font-weight: 900; color: #ef4444; }

    /* FILTRY */
    .filter-nav { 
        display: flex; 
        overflow-x: auto; 
        padding: 20px; 
        gap: 12px; 
        position: sticky; 
        top: 0; 
        background: rgba(241, 245, 249, 0.95); 
        backdrop-filter: blur(15px); 
        z-index: 100;
    }
    .f-btn { 
        background: var(--white); 
        border: none; 
        padding: 12px 25px; 
        border-radius: 50px; 
        font-weight: 700; 
        font-size: 14px; 
        white-space: nowrap; 
        transition: 0.3s; 
        color: #64748b;
        box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    }
    .f-btn.active { 
        background: var(--primary); 
        color: white; 
        box-shadow: 0 8px 20px rgba(30,58,138,0.3); 
    }

    /* KARTY NEWSÓW */
    .card { 
        background: var(--white); 
        margin: 25px; 
        border-radius: 40px; 
        overflow: hidden; 
        box-shadow: 0 15px 35px rgba(0,0,0,0.08); 
        border: 1px solid rgba(255,255,255,0.8);
        transition: transform 0.2s;
    }
    .card:active { transform: scale(0.98); }
    .card img { width: 100%; height: 250px; object-fit: cover; }
    
    /* STYL DLA WIDEO */
    .video-box { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; background: #000; }
    .video-box iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; }

    .card-body { padding: 30px; }
    .tag { 
        display: inline-block; 
        background: #dbeafe; 
        color: var(--accent); 
        font-size: 12px; 
        font-weight: 800; 
        padding: 8px 16px; 
        border-radius: 15px; 
        text-transform: uppercase; 
        margin-bottom: 15px; 
    }
    .news-title { 
        font-size: 22px; 
        font-weight: 800; 
        color: var(--text); 
        line-height: 1.35; 
    }

    /* PRZYCISK POWROTU */
    .back-bar { 
        display: none; 
        width: 90%; 
        padding: 24px; 
        background: #f59e0b; 
        color: white; 
        font-weight: 900; 
        border: none; 
        position: fixed; 
        bottom: 30px; 
        left: 5%; 
        z-index: 1000; 
        border-radius: 40px; 
        box-shadow: 0 20px 40px rgba(245,158,11,0.4); 
        font-size: 18px;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .loader { text-align: center; padding: 80px; font-weight: 800; color: var(--primary); font-size: 16px; letter-spacing: 1px; }
</style>
</head>
<body>

<button id="btn-back" class="back-bar" onclick="location.reload()"> POWROT DO GAZETY </button>

<div id="ui-main">
    <div class="header-top">
        <h1>MY SENIORZY</h1>
        <p id="today-info"></p>
    </div>

    <div id="city-search-box">
        <input type="text" id="city-input" placeholder="Wpisz miasto...">
        <button id="city-search-btn" onclick="szukajMiasta()">OK</button>
    </div>

    <div class="weather-section">
        <div class="tv-scroll" id="weather-list"></div>
    </div>

    <div class="filter-nav">
        <button class="f-btn active" onclick="filtruj('WSZYSTKO', this)">WSZYSTKO</button>
        <button class="f-btn" onclick="filtruj('WIDEO', this)">WIDEO</button>
        <button class="f-btn" onclick="filtruj('KRAJ', this)">KRAJ</button>
        <button class="f-btn" onclick="filtruj('KUCHNIA', this)">PRZEPISY</button>
        <button class="f-btn" onclick="filtruj('GWIAZDY', this)">GWIAZDY</button>
        <button class="f-btn" onclick="filtruj('ZDROWE', this)">ZDROWIE</button>
        <button class="f-btn" onclick="filtruj('PIENIADZE', this)">PIENIADZE</button>
        <button class="f-btn" onclick="filtruj('OGROD', this)">OGROD</button>
    </div>

    <div id="loader" class="loader">ŁADOWANIE GAZETY...</div>
    <div id="feed"></div>
</div>

<script>
    // TWOJA KONFIGURACJA
    const MOJ_KLUCZ_API = "AIzaSyBzkWjiKuVIRkw29UuU-m19eesjho_LskM";
    const proxy = "https://corsproxy.io/?";

    let rawData = [];

    const ytChannels = [
    {id: "UCU3G0HN066-T0sO_xEHzcyQ", n: "AKTYWNY SENIOR", tag: "WIDEO"},
    {id: "UCQJmMIOjSQd6G1p8rJvAYCQ", n: "Z PLANTA W OGRODZIE", tag: "WIDEO"},
    {id: "UCr4DCJIswpqn0vky29NCRAw", n: "KULINARNE PRZYGODY", tag: "WIDEO"},
    {id: "UCiKIhKlOfeQBhqHcO9ks4YA", n: "KUCHNIA MARIOLI", tag: "WIDEO"},
    {id: "UCGBhx6zgl8LEsYREj4HNW5Q", n: "MOMOTKI", tag: "WIDEO"},
    {id: "UCKAtPxfE2RAHSCwDABMMeAg", n: "JASNA GORA", tag: "WIDEO"},
    {id: "UCJ_qq-91XTS_0ryOUCm3VoA", n: "TVN STYLE", tag: "WIDEO"},
    {id: "UC0vOqF77gbkHvl_p2EHwicg", n: "TELEWIZJA POLSKA", tag: "WIDEO"}
];

    const sources = [
        {u: "https://www.rmf24.pl/feed", t: "KRAJ"},
        {u: "https://kobieta.interia.pl/kuchnia/feed", t: "KUCHNIA"},
        {u: "https://www.pomponik.pl/plotki/feed", t: "GWIAZDY"},
        {u: "https://rss.gazeta.pl/pub/rss/zdrowie.xml", t: "ZDROWE"},
        {u: "https://biznes.interia.pl/emerytury/feed", t: "PIENIADZE"},
        {u: "https://mojpieknyogrod.pl/rss/ogrod", t: "OGROD"}
    ];

    function fixTxt(s) {
        if(!s) return "";
        return s.replace(/[ąćęłńóśźżĄĆĘŁŃÓŚŹŻ]/g, c => ({'ą':'a','ć':'c','ę':'e','ł':'l','ń':'n','ó':'o','ś':'s','ź':'z','ż':'z','Ą':'A','Ć':'C','Ę':'E','Ł':'L','Ń':'N','Ó':'O','Ś':'S','Ź':'Z','??':'Z'}[c]));
    }

    document.getElementById('today-info').innerText = fixTxt(new Date().toLocaleDateString('pl-PL', { weekday: 'long', day: 'numeric', month: 'long' }));

    async function fetchYouTube(chan) {
        try {
            const url = `https://www.googleapis.com/youtube/v3/search?key=${MOJ_KLUCZ_API}&channelId=${chan.id}&part=snippet,id&order=date&maxResults=2&type=video`;
            const res = await fetch(url);
            const data = await res.json();
            if(!data.items) return [];
            return data.items.map(item => ({
                tytul: fixTxt(item.snippet.title),
                vid: item.id.videoId,
                tag: chan.tag,
                autor: chan.n,
                isV: true
            })).filter(v => v.vid);
        } catch (e) { return []; }
    }

    async function szukajMiasta() {
        let m = document.getElementById('city-input').value;
        if(!m) return;
        try {
            const geoUrl = `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(m)}`;
            const res = await fetch(proxy + encodeURIComponent(geoUrl));
            const data = await res.json();
            if(data && data.length > 0) {
                localStorage.setItem('mojeMiasto', JSON.stringify({ n: m, lat: data[0].lat, lon: data[0].lon }));
                location.reload();
            }
        } catch (e) { alert("Blad połączenia."); }
    }

    async function fetchTemp(m, container, isUser = false) {
        try {
            const response = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${m.lat}&longitude=${m.lon}&current_weather=true`);
            const data = await response.json();
            let card = document.createElement('div');
            card.className = isUser ? 'tv-card user-city' : 'tv-card';
            card.innerHTML = `<div class="tv-name">${fixTxt(m.n)}</div><div class="tv-item">${Math.round(data.current_weather.temperature)} stopni</div>`;
            container.appendChild(card);
        } catch (e) {}
    }

    async function initPogoda() {
        const resContainer = document.getElementById('weather-list');
        resContainer.innerHTML = "";
        const saved = localStorage.getItem('mojeMiasto');
        if(saved) { await fetchTemp(JSON.parse(saved), resContainer, true); }
        const miasta = [{n: "Warszawa", lat: 52.23, lon: 21.01}, {n: "Krakow", lat: 50.06, lon: 19.94}, {n: "Gdansk", lat: 54.35, lon: 18.64}];
        for(let m of miasta) { await fetchTemp(m, resContainer); }
        let addBtn = document.createElement('div');
        addBtn.className = 'add-city-btn';
        addBtn.onclick = () => { document.getElementById('city-search-box').style.display = 'block'; };
        addBtn.innerHTML = `<span style="font-size:24px">+</span><span>DODAJ</span>`;
        resContainer.appendChild(addBtn);
    }

    async function init() {
        initPogoda();
        let allItems = [];

        // 1. NEWSY
        const newsPromises = sources.map(async (s) => {
            try {
                const response = await fetch(proxy + encodeURIComponent(s.u));
                const txt = await response.text();
                const xml = new DOMParser().parseFromString(txt, "text/xml");
                xml.querySelectorAll("item").forEach(i => {
                    let img = "";
                    let m = i.getElementsByTagName("media:content")[0] || i.getElementsByTagName("enclosure")[0];
                    if(m) img = m.getAttribute("url");
                    allItems.push({
                        tytul: fixTxt(i.querySelector("title").textContent),
                        link: i.querySelector("link").textContent,
                        fotka: img, tag: s.t, isV: false
                    });
                });
            } catch (e) {}
        });

        // 2. FILMY (API GOOGLE)
        const videoResults = await Promise.all(ytChannels.map(c => fetchYouTube(c)));
        videoResults.forEach(res => allItems.push(...res));

        await Promise.all(newsPromises);
        
        rawData = allItems.sort(() => Math.random() - 0.5);
        document.getElementById('loader').style.display = 'none';
        render(rawData);
    }

    function render(list) {
        const c = document.getElementById('feed');
        c.innerHTML = "";
        list.forEach(item => {
            const d = document.createElement('div');
            d.className = 'card';
            if(item.isV) {
                d.innerHTML = `<div class="video-box">
                    <iframe src="https://www.youtube.com/embed/${item.vid}" 
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                            allowfullscreen></iframe>
                </div>
                <div class="card-body">
                    <span class="tag">${item.autor || item.tag}</span>
                    <div class="news-title">${item.tytul}</div>
                </div>`;
            } else {
                d.onclick = () => {
                    document.getElementById('ui-main').style.display = 'none';
                    document.getElementById('btn-back').style.display = 'block';
                    const f = document.createElement('iframe');
                    f.src = item.link; f.style.width="100%"; f.style.height="100vh"; f.style.border="none";
                    document.body.appendChild(f);
                };
                const img = item.fotka || `https://picsum.photos/seed/${Math.random()}/400/230`;
                d.innerHTML = `<img src="${img}"><div class="card-body"><span class="tag">${item.tag}</span><div class="news-title">${item.tytul}</div></div>`;
            }
            c.appendChild(d);
        });
    }

    function filtruj(kat, btn) {
        document.querySelectorAll('.f-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        if(kat === 'WSZYSTKO') render(rawData);
        else render(rawData.filter(x => x.tag === (kat === 'ZDROWIE' ? 'ZDROWE' : kat)));
    }

    init();
</script>
</body>
</html>
